<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="fr">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Ajouter un Client - E-Banking Pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
    <meta name="description" content="Ajouter un nouveau client - E-Banking Pro">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- CSS Links -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/Ajouter.css') }}">
</head>

<body>
    <div class="app-container">
         {% include 'sidebar.html' %}
        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- HEADER -->
            <div class="app-header">
                <div class="app-header__content">
                    <div class="app-header-left">
                        <h4 class="mb-0">Ajouter un Client</h4>
                    </div>
                </div>
            </div>

            <!-- MAIN CONTAINER -->
            <main class="main-container">
                <!-- Alert Messages -->
                <div class="alert success" style="display: none;">
                    <span class="alert-icon">‚úÖ</span>
                    Client cr√©√© avec succ√®s !
                </div>

                <!-- Form Container -->
                <div class="form-container">
                    <div class="form-header">
                        <h2 class="form-title">

                            D√©tails du Client
                        </h2>
                    </div>
                    
                    <div class="form-content">
                        <form method="POST">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label" for="nom">
                                        Nom de famille
                                        <span class="required-asterisk">*</span>
                                    </label>
                                    <div class="input-group">
                                        <span class="input-icon">üë§</span>
                                        <input type="text" 
                                               id="nom" 
                                               name="nom" 
                                               class="form-input" 
                                               placeholder="Entrez le nom de famille"
                                               required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="prenom">
                                        Pr√©nom
                                        <span class="required-asterisk">*</span>
                                    </label>
                                    <div class="input-group">
                                        <span class="input-icon">üë§</span>
                                        <input type="text" 
                                               id="prenom" 
                                               name="prenom" 
                                               class="form-input" 
                                               placeholder="Entrez le pr√©nom"
                                               required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="email">
                                        Adresse Email
                                        <span class="required-asterisk">*</span>
                                    </label>
                                    <div class="input-group">
                                        <span class="input-icon">‚úâÔ∏è</span>
                                        <input type="email" 
                                               id="email" 
                                               name="email" 
                                               class="form-input" 
                                               placeholder="exemple@email.com"
                                               required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions">
                                <a href="#" class="btn btn-secondary">
                                    <span class="btn-icon">‚Üê</span>
                                    Retour √† la liste
                                </a>
                                
                                <button type="submit" class="btn btn-primary">
                                    <span class="btn-icon">‚úÖ</span>
                                    Cr√©er le Client
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');
        const inputs = document.querySelectorAll('.form-input');
        const alertBox = document.querySelector('.alert');
        const submitBtn = document.querySelector('#submitBtn');
        const originalText = submitBtn.innerHTML;

        // Validation visuelle
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                this.classList.toggle('error', !this.value.trim());
            });

            input.addEventListener('input', function() {
                this.classList.remove('error');
            });
        });

        form.addEventListener('submit', function(e) {
            e.preventDefault();

            // Animation
            submitBtn.innerHTML = '<span class="btn-icon">‚è≥</span>Cr√©ation en cours...';
            submitBtn.disabled = true;

            const data = {
                nom: document.querySelector('#nom').value,
                prenom: document.querySelector('#prenom').value,
                email: document.querySelector('#email').value
            };

            fetch("/ajouter", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(response => {
                if (response.success) {
                    alertBox.style.display = 'flex';
                    form.reset();
                    setTimeout(() => {
                        alertBox.style.display = 'none';
                    }, 3000);
                } else {
                    alert(response.message || "Erreur inconnue");
                }
            })
            .catch(err => alert("Erreur serveur : " + err))
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });

        // Focus sur le premier champ
        const firstInput = document.querySelector('#nom');
        if (firstInput) firstInput.focus();
    });
</script>

</body>
</html>