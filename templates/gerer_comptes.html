<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Gérer les comptes</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/gerer_comptes.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>

<div class="gerer-comptes-container">
    <h2><i class="bi bi-gear-fill"></i> Gérer les comptes</h2>

    <!-- Formulaire de recherche -->
    <form method="POST" class="search-form">
        <label for="client_id">Rechercher par ID :</label>
        <div class="input-icon-group">
            <i class="bi bi-search input-icon"></i>
            <input type="text" name="client_id" placeholder="Entrer l'ID du client" required>
        </div>
        <button type="submit"><i class="bi bi-search"></i> Rechercher</button>
    </form>

    {% if client %}
        <hr>
        <div class="client-info">
            <p><strong>Nom :</strong> {{ client.nom }}</p>
            <p><strong>Prénom :</strong> {{ client.prenom }}</p>
            <p><strong>Email :</strong> {{ client.email }}</p>

            {% if client.comptes %}
                <h3>Comptes associés :</h3>
                {% for compte in client.comptes %}
                    <div class="compte-box">
                        <p><strong>Numéro :</strong> {{ compte.numero }}</p>
                        <p><strong>Intitulé :</strong> {{ compte.intitule or '—' }}</p>
                        <p><strong>Solde :</strong> {{ compte.solde }} {{ compte.devise }}</p>
                        <p><strong>Date création :</strong> {{ compte.date_creation }}</p>
                        <p><strong>Dernière opération :</strong> {{ compte.derniere_operation or '—' }}</p>
                        <p><strong>Plafond :</strong> {{ compte.plafond }}</p>
                        <p><strong>Autorise découvert :</strong> {{ 'Oui' if compte.autorise_decouvert else 'Non' }}</p>
                        <p><strong>Solde minimum :</strong> {{ compte.solde_minimum }}</p>
                        <p><strong>Statut compte :</strong> {{ compte.statut }}</p>
                        <p><strong>État carte :</strong> {{ compte.etat_carte }}</p>
                        <p><strong>Banque :</strong> {{ compte.banque_nom }}</p>
                        <p><strong>IBAN :</strong> {{ compte.iban or '—' }}</p>
                        <p><strong>Compte bloqué :</strong> {{ 'Oui' if compte.bloque else 'Non' }}</p>
                        <p><strong>Tentatives PIN :</strong> {{ compte.tentatives_pin }}</p>
                    </div>
                    <hr>
                {% endfor %}
            {% else %}
                <div class="message-orange">⚠️ Ce client n'a pas encore de compte associé.</div>
            {% endif %}
        </div>
    {% elif was_posted %}
        <div class="message-red">❌ Client introuvable</div>
    {% endif %}

    <!-- Bouton retour Accueil -->
    <div class="btn-retour">
        <a href="{{ url_for('dashboard') }}" class="btn-home">
            <i class="bi bi-house-fill"></i> Accueil
        </a>
    </div>
</div>

</body>
</html>
